// Onetime level controllers are like the regular type, except with respawns=false set.
// Meaning that their script only happensonce per playthrough.
{
is_strict: true,
id: "level_controller_onetime",
always_active: true,
hidden_in_game: true,
respawns: false,
zorder: "@include data/zorder.cfg:in_front_of_everything",

editor_info: { category: "controllers" },
on_end_anim: "animation('normal')",

//--------------------- Editor properties Init ---------------------------
on_being_added: "[set(x_bound, me.midpoint_x - 200), set(x2_bound, me.midpoint_x + 200),
                 set(y_bound, me.midpoint_y - 200), set(y2_bound, me.midpoint_y + 200)]",

properties: {
  //--------------------------  Editor properties --------------------------
  x_bound:  { type: "int", default: 0, editor_info: { type: "x" } },
  x2_bound: { type: "int", default: 0, editor_info: { type: "x" } },
  y_bound:  { type: "int", default: 0, editor_info: { type: "y" } },
  y2_bound: { type: "int", default: 0, editor_info: { type: "y" } },

  //--------------------- Properties ---------------------------
  last_triggered: { type: "int", default: -400 },
  player_within_bounds: "if(level.player.mid_x > x_bound and level.player.mid_x < x2_bound and
                         level.player.mid_y > y_bound and level.player.mid_y < y2_bound, 1, 0)",
},

on_process: "if(player_within_bounds and cycle - last_triggered > 250, [fire_event('triggered'), set(last_triggered, cycle)])",
on_triggered: "",


//--------------------- Animations ---------------------------
animation: {
  id: "normal",
  image: "effects/particles.png",
  x: 117,
  y: 73,
  w: 28,
  h: 28,
  //collide="0,0,28,28"
  frames: 1,
  duration: 1000,
},

} // EOF
